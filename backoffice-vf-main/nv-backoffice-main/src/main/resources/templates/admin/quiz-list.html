<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      lang="fr">

<!-- Remplace correctement le <head> via votre fragment -->
<head th:replace="~{fragments/layout :: layoutHead('Liste des quiz')}"></head>

<!-- Remplace le <body> via votre fragment en injectant navbar + content -->
<body th:replace="~{fragments/layout :: layoutBody(
                      ~{fragments/navbar :: navbar},
                      ~{::content}
                    )}">

<!-- Fragment CONTENT injecté dans layoutBody -->
<div th:fragment="content" class="container mt-4">

    <h1>Liste des quiz</h1>

    <!-- Créer un nouveau quiz : stopPropagation pour ne pas déclencher le tr#onclick -->
    <a th:href="@{/admin/quiz/nouveau}"
       class="btn btn-primary mb-3"
       onclick="event.stopPropagation()">
        Créer un nouveau quiz
    </a>

    <table class="table table-hover">
        <thead>
        <tr>
            <th>Image</th>
            <th>ID</th>
            <th>Titre</th>
            <th>Description</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody th:each="quiz : ${quizzes}">

        <!-- Clic sur la ligne : détail -->
        <tr th:onclick="|window.location='@{/admin/quiz/{id}(id=${quiz.id})}'|"
            style="cursor:pointer">

            <!-- Image -->
            <td>
                <img th:if="${quiz.imageUrl}"
                     th:src="@{'/uploads/' + ${quiz.imageUrl}}"
                     class="img-thumbnail"
                     style="max-width:100px"
                     alt="Visuel du quiz"/>
            </td>

            <!-- ID (lien vers détail + stopPropagation) -->
            <td>
                <a th:href="@{/admin/quiz/{id}(id=${quiz.id})}"
                   th:text="${quiz.id}"
                   onclick="event.stopPropagation()">
                </a>
            </td>

            <!-- Titre (idem) -->
            <td>
                <a th:href="@{/admin/quiz/{id}(id=${quiz.id})}"
                   th:text="${quiz.titre}"
                   onclick="event.stopPropagation()">
                </a>
            </td>

            <!-- Description -->
            <td th:text="${quiz.description}">Description</td>

            <!-- Actions -->
            <td>
                <!-- Modifier -->
                <a th:href="@{/admin/quiz/{id}/modifier(id=${quiz.id})}"
                   class="btn btn-sm btn-outline-secondary"
                   onclick="event.stopPropagation()">
                    Modifier
                </a>

                <!-- Supprimer en GET, avec confirmation + stopPropagation -->
                <a th:href="@{/admin/quiz/{id}/supprimer(id=${quiz.id})}"
                   class="btn btn-sm btn-outline-danger"
                   onclick="
                   event.stopPropagation();
                   return confirm('Vraiment supprimer ce quiz ?');
                 ">
                    Supprimer
                </a>
            </td>

        </tr>
        </tbody>
    </table>

</div>

</body>
</html>
